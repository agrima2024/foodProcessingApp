!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).ZXing={})}(this,function(t){"use strict";var e,r;(e=r||(r={}))[e.AZTEC=0]="AZTEC",e[e.CODABAR=1]="CODABAR",e[e.CODE_39=2]="CODE_39",e[e.CODE_93=3]="CODE_93",e[e.CODE_128=4]="CODE_128",e[e.DATA_MATRIX=5]="DATA_MATRIX",e[e.EAN_8=6]="EAN_8",e[e.EAN_13=7]="EAN_13",e[e.ITF=8]="ITF",e[e.MAXICODE=9]="MAXICODE",e[e.PDF_417=10]="PDF_417",e[e.QR_CODE=11]="QR_CODE",e[e.RSS_14=12]="RSS_14",e[e.RSS_EXPANDED=13]="RSS_EXPANDED",e[e.UPC_A=14]="UPC_A",e[e.UPC_E=15]="UPC_E",e[e.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION";var n,i;(n=i||(i={}))[n.OTHER=0]="OTHER",n[n.PURE_BARCODE=1]="PURE_BARCODE",n[n.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",n[n.TRY_HARDER=3]="TRY_HARDER",n[n.CHARACTER_SET=4]="CHARACTER_SET",n[n.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",n[n.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",n[n.ASSUME_GS1=7]="ASSUME_GS1",n[n.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",n[n.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",n[n.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS";var a=function(){function t(t,e,r){void 0===r&&(r=void 0),this.source=t,this.binarizer=e,this.hints=r}return t.prototype.getLuminanceSource=function(){return this.source},t.prototype.getBinarizer=function(){return this.binarizer},t.prototype.getHints=function(){return this.hints},t.prototype.getBinaryBitmap=function(){return this.binarizer.getBlackMatrix()},t}();var o=function(t,e,r,n){this.x=t,this.y=e,this.estimatedModuleSize=r,this.count=n,this.x=t,this.y=e,this.estimatedModuleSize=r,this.count=n};Object.defineProperty(o.prototype,"getX",{enumerable:!1,configurable:!0,get:function(){return this.x}}),Object.defineProperty(o.prototype,"getY",{enumerable:!1,configurable:!0,get:function(){return this.y}}),Object.defineProperty(o.prototype,"getEstimatedModuleSize",{enumerable:!1,configurable:!0,get:function(){return this.estimatedModuleSize}}),Object.defineProperty(o.prototype,"getCount",{enumerable:!1,configurable:!0,get:function(){return this.count}}),o.prototype.aboutEquals=function(t,e,r){if(Math.abs(e-this.y)<=t&&Math.abs(r-this.x)<=t){var n=Math.abs(t-this.estimatedModuleSize);return n<=1||n<=this.estimatedModuleSize}return!1},o.prototype.combineEstimate=function(t,e,r){var n=this.count+t.count,i=(this.count*this.y+t.count*e)/n,a=(this.count*this.x+t.count*r)/n,s=(this.count*this.estimatedModuleSize+t.count*t.estimatedModuleSize)/n;return new o(a,i,s,n)},o.prototype.equals=function(t){return t instanceof o&&this.x===t.x&&this.y===t.y},o.prototype.hashCode=function(){return 31*this.x+this.y};var s=function(){function t(t,e){this.text=t,this.rawBytes=e,this.numBits=null==e?0:8*e.length,this.resultPoints=[],this.format=null,this.resultMetadata=null,this.timestamp=Date.now()}return t.prototype.getText=function(){return this.text},t.prototype.getRawBytes=function(){return this.rawBytes},t.prototype.getNumBits=function(){return this.numBits},t.prototype.getResultPoints=function(){return this.resultPoints},t.prototype.getBarcodeFormat=function(){return this.format},t.prototype.getResultMetadata=function(){return this.resultMetadata},t.prototype.putMetadata=function(t,e){null===this.resultMetadata&&(this.resultMetadata=new Map),this.resultMetadata.set(t,e)},t.prototype.putAllMetadata=function(t){null!=t&&((null===this.resultMetadata?this.resultMetadata=t:this.resultMetadata=new Map(Array.from(this.resultMetadata).concat(Array.from(t))))
)},t.prototype.addResultPoints=function(t){var e=this.resultPoints;null!=e&&null!=t&&t.length>0&&(this.resultPoints=e.concat(t))},t.prototype.getTimestamp=function(){return this.timestamp},t.prototype.toString=function(){return this.text},t}();var u,l;(u=l||(l={}))[u.ERROR_CORRECTION_LEVEL=0]="ERROR_CORRECTION_LEVEL",u[u.ISSUE_NUMBER=1]="ISSUE_NUMBER",u[u.SUGGESTED_PRICE=2]="SUGGESTED_PRICE",u[u.POSSIBLE_COUNTRY=3]="POSSIBLE_COUNTRY",u[u.UPC_EAN_EXTENSION=4]="UPC_EAN_EXTENSION",u[u.PDF417_EXTRA_METADATA=5]="PDF417_EXTRA_METADATA",u[u.STRUCTURED_APPEND_SEQUENCE=6]="STRUCTURED_APPEND_SEQUENCE",u[u.STRUCTURED_APPEND_PARITY=7]="STRUCTURED_APPEND_PARITY",u[u.SYMBOLOGY_IDENTIFIER=8]="SYMBOLOGY_IDENTIFIER",u[u.BYTE_SEGMENTS=9]="BYTE_SEGMENTS";var c=function(t){function e(e,r,n,i,a,o){void 0===o&&(o=Date.now());var s=t.call(this,e,r,o)||this;return s.numBits=n,s.resultPoints=i,s.format=a,s.resultMetadata=null,s}return __extends(e,t),e}(s);var d,h;function f(t){for(var e=t.length,r=0;e--;)r+=t[e].getEstimatedModuleSize();return r}function p(t){if(t.length<3)return!1;for(var e=f(t),r=e/7,n=r/2,i=0,a=t.length;i<a;i++){var o=t[i];if(Math.abs(o.getEstimatedModuleSize()-r)>n)return!1}return!0}function g(t){for(var e=f(t),r=e/37,n=r/2,i=0,a=t.length;i<a;i++){var o=t[i];if(Math.abs(o.getEstimatedModuleSize()-r)>n)return!1}return!0}(d=h||(h={}))[d.L=0]="L",d[d.M=1]="M",d[d.Q=2]="Q",d[d.H=3]="H";var m=function(){function t(t,e,r){this.value=t,this.stringValue=e,this.bits=r}return t.prototype.getValue=function(){return this.value},t.prototype.getStringValue=function(){return this.stringValue},t.prototype.getBits=function(){return this.bits},t.values=new Map,t.getECIByValue=function(e){if(e<0||e>999999)throw new Error("Bad ECI value: "+e);return t.values.has(e)?t.values.get(e):void 0},t.addECI=function(e,r,n){var i=new t(e,r,n);t.values.set(e,i)},t}(),v=function(t){var e;try{for(var r=__values(E.values()),n=r.next();!n.done;n=r.next()){var i=n.value;if(i.getName()===t||i.getOtherName()===t)return i.getCharset()}}catch(a){e={error:a}}finally{try{n&&!n.done&&(e=r.return)}finally{if(e)throw e.error}}return null},y=function(t){var e;try{for(var r=__values(E.values()),n=r.next();!n.done;n=r.next()){var i=n.value;if(i.getName()===t||i.getOtherName()===t)return i}}catch(a){e={error:a}}finally{try{n&&!n.done&&(e=r.return)}finally{if(e)throw e.error}}return null},b=function(t){var e;try{for(var r=__values(E.values()),n=r.next();!n.done;n=r.next()){var i=n.value;if(i.getName()===t||i.getOtherName()===t)return i}}catch(a){e={error:a}}finally{try{n&&!n.done&&(e=r.return)}finally{if(e)throw e.error}}return null},E=function(){function t(t,e,r,n){var i=this;this.name=t,this.otherName=e,this.charset=r,this.values=n,this.getName=function(){return i.name},this.getOtherName=function(){return i.otherName},this.getCharset=function(){return i.charset},this.getValue=function(t){var e=i.values.indexOf(t);return-1===e?null:e}}return t.values=function(){return[E.Cp437,E.ISO8859_1,E.ISO8859_2,E.ISO8859_3,E.ISO8859_4,E.ISO8859_5,E.ISO8859_6,E.ISO8859_7,E.ISO8859_8,E.ISO8859_9,E.ISO8859_10,E.ISO8859_11,E.ISO8859_13,E.ISO8859_14,E.ISO8859_15,E.ISO8859_16,E.SJIS,E.Cp1250,E.Cp1251,E.Cp1252,E.Cp1256,E.UnicodeBigUnmarked,E.UTF8,E.ASCII,E.GB18030,E.EUC_KR]},t}();E.Cp437=new E("Cp437","IBM437",v("IBM437"),[0,2]),E.ISO8859_1=new E("ISO-8859-1","ISO8859_1",v("ISO8859_1"),[1,3]),E.ISO8859_2=new E("ISO-8859-2","ISO8859_2",v("ISO8859_2"),[4]),E.ISO8859_3=new E("ISO-8859-3","ISO8859_3",v("ISO8859_3"),[5]),E.ISO8859_4=new E("ISO-8859-4","ISO8859_4",v("ISO8859_4"),[6]),E.ISO8859_5=new E("ISO-8859-5","ISO8859_5",v("ISO8859_5"),[7]),E.ISO8859_6=new E("ISO-8859-6","ISO8859_6",v("ISO8859_6"),[8]),E.ISO8859_7=new E("ISO-8859-7","ISO8859_7",v("ISO8859_7"),[9]),E.ISO8859_8=new E("ISO-8859-8","ISO8859_8",v("ISO8859_8"),[10]),E.ISO8859_9=new E("ISO-8859-9","ISO8859_9",v("ISO8859_9"),[11]),E.ISO8859_10=new E("ISO-8859-10","ISO8859_10",v("ISO8859_10"),[12]),E.ISO8859_11=new E("ISO-8859-11","ISO8859_11",v("ISO8859_11"),[13]),E.ISO8859_13=new E("ISO-8859-13","ISO8859_13",v("ISO8859_13"),[15]),E.ISO8859_14=new E("ISO-8859-14","ISO8859_14",v("ISO8859_14"),[16]),E.ISO8859_15=new E("ISO-8859-15","ISO8859_15",v("ISO8859_15"),[17]),E.ISO8859_16=new E("ISO-8859-16","ISO8859_16",v("ISO8859_16"),[18]),E.SJIS=new E("SJIS","Shift_JIS",v("Shift_JIS"),[20]),E.Cp1250=new E("Cp1250","windows-1250",v("windows-1250"),[21]),E.Cp1251=new E("Cp1251","windows-1251",v("windows-1251"),[22]),E.Cp1252=new E("Cp1252","windows-1252",v("windows-1252"),[23]),E.Cp1256=new E("Cp1256","windows-1256",v("windows-1256"),[24]),E.UnicodeBigUnmarked=new E("UnicodeBigUnmarked","UTF-16BE",v("UTF-16BE"),[25]),E.UTF8=new E("UTF8","UTF-8",v("UTF-8"),[26]),E.ASCII=new E("ASCII","US-ASCII",v("US-ASCII"),[27,170]),E.GB18030=new E("GB18030","GB2312",v("GB2312"),[29]),E.EUC_KR=new E("EUC_KR","EUC-KR",v("EUC-KR"),[30]);var C=function(){function t(){}return t.decode=function(t,e){var r=v(e);return new TextDecoder(r).decode(t)},t.encode=function(t,e){var r=b(e);return new TextEncoder(r.getName(),{NONSTANDARD_allowLegacyEncoding:!0}).encode(t)},t}();var w=function(){function t(t,e){var r,n,i,a=this;this.canvas=t,this.context=e,this.ImageData=function(){var t,e=a.context.getImageData(0,0,a.canvas.width,a.canvas.height);try{for(var n=__values(Object.keys(e)),o=n.next();!o.done;o=n.next()){var s=o.value;a[s]=e[s]}}catch(u){t={error:u}}finally{try{o&&!o.done&&(r=n.return)}finally{if(t)throw t.error}}return a},this.resize=function(t,e){a.canvas.width=t,a.canvas.height=e},this.putImageData=function(t,e,r){void 0===e&&(e=0),void 0===r&&(r=0),a.context.putImageData(t,e,r)},this.getImageData=function(t,e,r,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=this.canvas.width),void 0===n&&(n=this.canvas.height),a.context.getImageData(t,e,r,n)},this.fillRect=function(t,e,r,n){a.context.fillRect(t,e,r,n)},Object.defineProperty(this,"fillStyle",{set:function(t){a.context.fillStyle=t},enumerable:!1,configurable:!0}),this.translate=function(t,e){a.context.translate(t,e)},this.scale=function(t,e){a.context.scale(t,e)},this.toDataURL=function(t,e){return a.canvas.toDataURL(t,e)},this.getCanvas=function(){return a.canvas},this.getContext=function(){return a.context},this.loadImage=function(t,e,o,s,u){return void 0===e&&(e=0),void 0===o&&(o=0),void 0===s&&(s=a.canvas.width),void 0===u&&(u=a.canvas.height),__awaiter(a,void 0,void 0,function(){var a=this;return __generator(this,function(l){switch(l.label){case 0:return[4,new Promise(function(l,c){var d=new Image;d.onload=function(){a.context.drawImage(d,e,o,s,u),l(d)},d.onerror=c,d.src=t})];case 1:return[2,l.sent()]}})})},this.drawImage=function(t,e,r,n,i){a.context.drawImage(t,e,r,n,i)},this.destroy=function(){a.context.clearRect(0,0,a.canvas.width,a.canvas.height),a.canvas.width=0,a.canvas.height=0},this.isDestroyed=function(){return 0===a.canvas.width||0===a.canvas.height}}return t.create=function(e,r){var n,i=document.createElement("canvas");i.width=e,i.height=r;var a=i.getContext("2d",{willReadFrequently:!0});return a||(null===(n=console)||void 0===n?void 0:n.error("This browser does not support CanvasRenderingContext2D.","Probably you need to use a different browser.")),new t(i,a)},t.fromCanvas=function(e){var r,n=e.getContext("2d",{willReadFrequently:!0});return n||(null===(r=console)||void 0===r?void 0:r.error("This browser does not support CanvasRenderingContext2D.","Probably you need to use a different browser.")),new t(e,n)},t.fromImage=function(e,r,n){var i=document.createElement("canvas");r?i.width=r:i.width=e.naturalWidth,n?i.height=n:i.height=e.naturalHeight;var a,o=i.getContext("2d",{willReadFrequently:!0});o||(null===(a=console)||void 0===a?void 0:a.error("This browser does not support CanvasRenderingContext2D.","Probably you need to use a different browser."));var s=new t(i,o);return s.drawImage(e,0,0,i.width,i.height),s},t.fromImageData=function(e){var r=document.createElement("canvas");r.width=e.width,r.height=e.height;var n,i=r.getContext("2d",{willReadFrequently:!0});i||(null===(n=console)||void 0===n?void 0:n.error("This browser does not support CanvasRenderingContext2D.","Probably you need to use a different browser."));var a=new t(r,i);return a.putImageData(e,0,0),a},t}(),S=function(){function t(){}return t.add=function(t,e){return t+e},t.multiply=function(t,e){return t*e},t.subtract=function(t,e){return t-e},t.castAsInteger=function(t){return Math.trunc(t)},t.round=function(t){return Math.round(t)},t.sum=function(t){var e,r;if(null==t||0===t.length)return 0;for(var n=0,i=0,a=t.length;i<a;i++)n+=t[i];return n},t.getStandardDeviation=function(t,e,r){var n,i=t.length,a=e/i,o=0;for(n=0;n<i;n+=1){var s=t[n]-a;o+=s*s}return Math.sqrt(o/r)},t.floatToIntBits=function(t){return t},t}();function _(t){for(var e=0,r=0,n=t.length;r<n;r++)e+=t[r];return e}S.MIN_VALUE_32_BITS=-(S.MAX_VALUE_32_BITS=2147483647)-1;var A=function(){function t(){}return t.getCharCode=function(t,e){return void 0===e&&(e=0),t.charCodeAt(e)},t.getCharAt=function(t){return String.fromCharCode(t)},t.compareTo=function(t,e){return t.localeCompare(e)},t.isDigit=function(t){return t>=48&&t<=57},t.isLetter=function(t){return t>=65&&t<=90||t>=97&&t<=122},t.isLetterOrDigit=function(t){return t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57},t.isWhitespace=function(t){return 32===t||10===t||13===t||9===t},t.isHexDigit=function(t){return t>=48&&t<=57||t>=65&&t<=70||t>=97&&t<=102},t.isUrl=function(t){var e=new RegExp("^(https?|ftp|file)://[-a-zA-Z0-9+&@#/%?=~_|!:,.;]*[-a-zA-Z0-9+&@#/%=~_|]");return e.test(t)},t.isAlpha=function(t){return t>=65&&t<=90||t>=97&&t<=122},t.isAlphanumeric=function(t){return this.isDigit(t)||this.isAlpha(t)},t.repeat=function(t,e){return e.repeat(t)},t}();var I=function(t){var e=this;this.value=t,this.append=function(t){return"string"==typeof t?e.value+=t:e.value+=A.getCharAt(t),"number"==typeof t||void 0},this.appendChars=function(t,r,n){for(var i=r;i<r+n;i++)e.value+=A.getCharAt(t[i]);return this},this.length=function(){return e.value.length},this.charAt=function(t){return e.value.charAt(t)},this.deleteCharAt=function(t){e.value=e.value.substr(0,t)+e.value.substring(t+1)},this.setCharAt=function(t,r){e.value=e.value.substr(0,t)+r+e.value.substr(t+1)},this.substring=function(t,r){return void 0===r?e.value.substring(t):e.value.substring(t,r)},this.setLengthToZero=function(){e.value=""},this.toString=function(){return e.value},this.insert=function(t,r){e.value=e.value.substr(0,t)+r+e.value.substr(t)},this.replace=function(t,r,n){return e.value=e.value.substr(0,t)+n+e.value.substr(r)},this.indexOf=function(t,r){return e.value.indexOf(t,r)},this.lastIndexOf=function(t,r){return e.value.lastIndexOf(t,r)}};var R=function(t){function e(){var e=t.call(this)||this;return e.string=new I(""),e}return __extends(e,t),e.prototype.read=function(){return this.string.length()},e.prototype.readBytes=function(t,e,r){var n=this.string.substring(e,r);return C.encode(n,E.ISO8859_1)},e.prototype.write=function(t){this.string.append(t)},e.prototype.writeBytes=function(t){var e=C.decode(t,E.ISO8859_1);this.string.append(e)},e.prototype.toByteArray=function(){var t=this.string.toString();return C.encode(t,E.ISO8859_1)},e}(function(){function t(){}return t.prototype.size=function(){return this.length},t.prototype.isEmpty=function(){return 0===this.length},t}());var L="function"==typeof Symbol&&Symbol.iterator,M="@@iterator",x=function(t){var e,r;this.arr=t,this.from=function(t){return new x(Array.from(t))},this.size=function(){return this.arr.length},this.get=function(t){return this.arr[t]},this.add=function(t){this.arr.push(t)},this.addComponents=function(t,e,r){var n=Array.from(t).slice(e,r);this.arr=this.arr.concat(n)},this.addAll=function(t){this.arr=this.arr.concat(t.arr)},this.set=function(t,e){this.arr[t]=e,this},this.remove=function(t){this.arr.splice(t,1)},this.removeRange=function(t,e){var r=this.arr.slice(0,t),n=this.arr.slice(e,this.arr.length);this.arr=r.concat(n)},this.clear=function(){this.arr.splice(0,this.arr.length)},this.contains=function(t){return-1!==this.arr.indexOf(t)},this.indexOf=function(t){return this.arr.indexOf(t)},this.lastIndexOf=function(t){return this.arr.lastIndexOf(t)},this.isEmpty=function(){return 0===this.arr.length},this.toArray=function(){return this.arr},this.sort=function(t){this.arr.sort(t)},this.clone=function(){return new x(this.arr.slice())},this.equals=function(t){return this.arr.every(function(e,r){return e===t.get(r)})},this.hashCode=function(){return this.arr.reduce(function(t,e){return t+e.hashCode()},0)},this.toString=function(){return this.arr.join()},this.iterator=L?function(){var t=this;return e={next:function(){var e=t.arr.shift();return{done:null==e,value:e}}},e}[L]():(e={},e[M]=this.iterator,e),this.getUnderlyingArray=function(){return this.arr},this[Symbol.iterator]=this.iterator,this.stream=function(){return r=this,new T(r.toArray())}};function T(t){this.source=t,this.filtered=this.source,this.isFiltered=!1}T.prototype.filter=function(t){return this.filtered=this.source.filter(t),this.isFiltered=!0,this},T.prototype.get=function(){return this.filtered},T.prototype.count=function(){return this.filtered.length};var B=function(){function t(){}return t.fill=function(t,e){for(var r=0,n=t.length;r<n;r++)t[r]=e},t.fillWithin=function(t,e,r,n){for(var i=e;i<r;i++)t[i]=n},t.copyOf=function(t,e){var r=new Int32Array(e),n=t.length<e?t.length:e;return r.set(t.slice(0,n)),r},t.copyOfUint8Array=function(t,e){var r=new Uint8Array(e),n=t.length<e?t.length:e;return r.set(t.slice(0,n)),r},t.copyOfRange=function(t,e,r){var n=r-e,i=new Int32Array(n);return i.set(t.slice(e,r)),i},t.binarySearch=function(t,e,r){void 0===r&&(r=this.numberComparator);var n=0,i=t.length-1;for(;n<=i;){var a=n+i>>1;if(r(t[a],e)<0)n=a+1;else{if(!(r(t[a],e)>0))return a;i=a-1}}return-(n+1)},t.equals=function(t,e){if(!t)return!e;if(!e)return!1;if(t.length!==e.length)return!1;for(var r=0,n=t.length;r<n;r++)if(t[r]!==e[r])return!1;return!0},t.hashCode=function(t){if(null===t)return 0;var e=1,r=0,n=t.length;for(;r<n;r++)e=31*e+t[r];return e},t.numberComparator=function(t,e){return t-e},t.create=function(t){return new Int32Array(t)},t.createAndFill=function(t,e){var r=new Int32Array(t);return this.fill(r,e),r},t.createFrom=function(t){return new Int32Array(t)},t.createUint8Array=function(t){return t instanceof Uint8Array?new Uint8Array(t):new Uint8Array(t)},t.createInt32Array=function(t){return t instanceof Int32Array?new Int32Array(t):new Int32Array(t)},t.isTypedArray=function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},t.sort=function(t,e){t.sort(e)},t}();var O=function(){function t(e,r){var n=this;this.width=e,this.height=r,this.rowSize=(e+31)/32,this.bits=new Int32Array(this.rowSize*r),this.get=function(t,e){var r=e*n.rowSize+Math.floor(t/32);return 0!=(n.bits[r]>>>t%32&1)},this.set=function(t,e){var r=e*n.rowSize+Math.floor(t/32);n.bits[r]|=1<<t%32},this.unset=function(t,e){var r=e*n.rowSize+Math.floor(t/32);n.bits[r]&=~(1<<t%32)},this.flip=function(t,e){var r=e*n.rowSize+Math.floor(t/32);n.bits[r]^=1<<t%32},this.xor=function(t){if(n.width!==t.getWidth()||n.height!==t.getHeight()||n.rowSize!==t.getRowSize())throw new Error("Input matrix dimensions do not match");for(var e=new O(n.width,n.height),r=0;r<n.bits.length;r++)e.bits[r]=n.bits[r]^t.bits[r];return e},this.clear=function(){for(var t=n.bits.length,e=0;e<t;e++)n.bits[e]=0},this.setRegion=function(t,e,r,i){if(e<0||t<0)throw new Error("Left and top must be nonnegative");if(i<1||r<1)throw new Error("Height and width must be at least 1");var a=t+r,o=e+i;if(o>n.height||a>n.width)throw new Error("The region must fit inside the matrix");for(var s=e;s<o;s++)for(var u=s*n.rowSize,l=t;l<a;l++)n.bits[u+Math.floor(l/32)]|=1<<l%32},this.getRow=function(e,r){null==r||r.getSize()<n.width?r=new P(n.width):r.clear();for(var i=e*n.rowSize,a=0;a<n.rowSize;a++)for(var o=n.bits[i+a],s=0;s<32;s++){var u=32*a+s;if(u>=n.width)break;0!=(o>>s&1)&&r.set(u)}return r},this.setRow=function(t,e){var r=t*n.rowSize;B.fillWithin(n.bits,r,r+n.rowSize,0);for(var i=0,a=e.getSize();i<a;i++){var o=e.get(i);o&&n.set(i,t)}},this.rotate=function(t){var e,r,i=n.getWidth(),a=n.getHeight(),o=new O(a,i);if(t%360===0)return o.bits=Int32Array.from(n.bits),o;if(t%360===90)for(e=0;e<a;e+=1)for(r=0;r<i;r+=1)n.get(r,e)&&o.set(e,i-r-1);else if(t%360===180)for(e=0;e<a;e+=1)for(r=0;r<i;r+=1)n.get(r,e)&&o.set(i-r-1,a-e-1);else{if(t%360!==270)throw new Error("Only 90, 180, 270 degrees supported for rotation.");for(e=0;e<a;e+=1)for(r=0;r<i;r+=1)n.get(r,e)&&o.set(a-e-1,r)}return o},this.rotate180=function(){var t=this.getWidth(),e=this.getHeight(),r=new P(t),n=new P(t);for(e%2==1&&(n=this.getRow(S.castAsInteger(e/2),r)),i=0;i<S.castAsInteger(e/2);i++){r=this.getRow(i,r),n=this.getRow(e-1-i,n),r.reverse(),n.reverse(),this.setRow(i,n),this.setRow(e-1-i,r)}var i},this.enclosingRectangle=function(){var t=this.width,e=this.height,r=-1,i=-1;for(o=0;o<this.height;o++)for(s=0;s<this.rowSize;s++){var a=this.bits[o*this.rowSize+s];if(0!==a)for(o<e&&(e=o),o>i&&(i=o),u=0;u<32;u++)if(0!=(a>>31-u&1)){var o,s,u,l=32*s+31-u;l<t&&(t=l),l>r&&(r=l)}}if(r<t||i<e)return null;var c=new Int32Array([t,e,r-t+1,i-e+1]);return c},this.getTopLeftOnBit=function(){for(var t=0;t<this.bits.length&&0===this.bits[t];)t++;if(t===this.bits.length)return null;var e=t/this.rowSize,r=t%this.rowSize*32,n=this.bits[t],i=0;for(;n<<31-i==0;)i++;return r+=i,new Int32Array([r,e])},this.getBottomRightOnBit=function(){for(var t=this.bits.length-1;t>=0&&0===this.bits[t];)t--;if(t<0)return null;var e=Math.floor(t/this.rowSize),r=t%this.rowSize*32,n=this.bits[t],i=31;for(;n>>>i==0;)i--;return r+=i,new Int32Array([r,e])},this.getWidth=function(){return n.width},this.getHeight=function(){return n.height},this.getRowSize=function(){return n.rowSize},this.equals=function(t){if(!(t instanceof O)||n.width!==t.width||n.height!==t.height||n.rowSize!==t.rowSize||n.bits.length!==t.bits.length)return!1;for(var e=0;e<n.bits.length;e++)if(n.bits[e]!==t.bits[e])return!1;return!0},this.clone=function(){var t=new O(n.width,n.height);return t.bits=new Int32Array(n.bits),t},this.toString=function(t,e,r){void 0===t&&(t="X "),void 0===e&&(e="  "),void 0===r&&(r="\n");for(var i=new I,a=0;a<n.height;a++){for(var o=0;o<n.width;o++)i.append(n.get(o,a)?t:e);i.append(r)}return i.toString()},this.toJSON=function(){return{width:this.width,height:this.height,rowSize:this.rowSize,bits:Array.from(this.bits)}}}return t}();var P=function(){function t(t){var e=this;t instanceof Int32Array?this.bits=Int32Array.from(t):(this.size=t,this.bits=B.create(Math.floor((t+31)/32))),this.getSize=function(){return e.size},this.getSizeInBytes=function(){return Math.floor((e.size+7)/8)},this.get=function(t){return 0!=(e.bits[Math.floor(t/32)]>>t%32&1)},this.set=function(t){e.bits[Math.floor(t/32)]|=1<<t%32},this.flip=function(t){e.bits[Math.floor(t/32)]^=1<<t%32},this.getNextSet=function(t){if(t>=e.size)return e.size;for(var r=Math.floor(t/32),n=e.bits[r],i=t%32;n&=-(1<<i),0===n;){if(++r===e.bits.length)return e.size;n=e.bits[r]}var a=32*r+S.numberOfTrailingZeros(n);return a>e.size?e.size:a},this.getNextUnset=function(t){if(t>=e.size)return e.size;for(var r=Math.floor(t/32),n=~e.bits[r],i=t%32;n&=-(1<<i),0===n;){if(++r===e.bits.length)return e.size;n=~e.bits[r]}var a=32*r+S.numberOfTrailingZeros(n);return a>e.size?e.size:a},this.setBulk=function(t,r){e.bits[Math.floor(t/32)]=r},this.setRange=function(t,r){if(r<t||t<0||r>e.size)throw new Error;if(r===t)return;var n=Math.floor(t/32),i=Math.floor((r-1)/32);if(n===i){var a=0;a|=-(1<<t%32),a|=2147483647>>>31-(r-1)%32,e.bits[n]|=a}else{var o=-(1<<t%32);e.bits[n]|=o;for(var s=n+1;s<i;s++)e.bits[s]=-1;var u=2147483647>>>31-(r-1)%32;e.bits[i]|=u}},this.clear=function(){var t=e.bits.length;for(var r=0;r<t;r++)e.bits[r]=0},this.isRange=function(t,r,n){if(r<t||t<0||r>e.size)throw new Error;if(r===t)return!0;r--;var i=Math.floor(t/32),a=Math.floor(r/32);if(i===a){var o=0;o|=-(1<<t%32),o|=2147483647>>>31-r%32;return(e.bits[i]&o)===(n?o:0)}var s=-(1<<t%32);if((e.bits[i]&s)!==(n?s:0))return!1;for(var u=i+1;u<a;u++)if(e.bits[u]!==(n?-1:0))return!1;var l=2147483647>>>31-r%32;return(e.bits[a]&l)===(n?l:0)},this.appendBit=function(t){throw new Error("not implemented, should not be used in JS")},this.appendBitArray=function(t){throw new Error("not implemented, should not be used in JS")},this.xor=function(t){if(e.size!==t.size)throw new Error("Sizes don't match");for(var r=0;r<e.bits.length;r++)e.bits[r]^=t.bits[r]},this.toBytes=function(t,r,n,i){for(var a=0;a<i;a++){for(var o=0,s=0;s<8;s++)e.get(t)&&(o|=1<<7-s),t++;r[n+a]=o}},this.getBitArray=function(){return e.bits},this.reverse=function(){for(var t=new Int32Array(e.bits.length),r=Math.floor((e.size-1)/32),n=r;n>=0;n--){var i=e.bits[n];i=(i&1431655765)<<1|(i>>>1&1431655765),i=(i&858993459)<<2|(i>>>2&858993459),i=(i&252645135)<<4|(i>>>4&252645135),i=(i<<24|i>>8)&16711935|(i<<8|i>>>24)&4278255360,t[r-n]=i}if(e.size%32!=0){var a=e.size%32,o=32-a,s=(1<<a)-1,u=t[0]>>>o&s;for(n=0;n<r;n++){var l=t[n]<<a|t[n+1]>>>o;t[n]=l}t[r]=u}e.bits=t},this.equals=function(t){if(!(t instanceof P)||e.size!==t.size)return!1;for(var r=0;r<e.bits.length;r++)if(e.bits[r]!==t.bits[r])return!1;return!0},this.clone=function(){return new P(Int32Array.from(this.bits))},this.toString=function(){for(var t=new I,r=0;r<e.size;r++)0==(r&7)&&t.append(" "),(e.get(r)?t.append("X"):t.append("."));return t.toString()}}return t}();var U,k;(U=k||(k={}))[U.ALPHA=0]="ALPHA",U[U.LOWER=1]="LOWER",U[U.MIXED=2]="MIXED",U[U.PUNCT=3]="PUNCT",U[U.ALPHA_SHIFT=4]="ALPHA_SHIFT",U[U.PUNCT_SHIFT=5]="PUNCT_SHIFT";var D,F;(D=F||(F={}))[D.UPPER=0]="UPPER",D[D.LOWER=1]="LOWER",D[D.DIGIT=2]="DIGIT",D[D.MIXED=3]="MIXED",D[D.PUNCTUATION=4]="PUNCTUATION";var z=function(){function t(t,e,r,n,i){var a=this;this.width=t,this.height=e,this.bytes=r,this.dataWidth=n,this.dataHeight=i,this.left=0,this.top=0,this.getLuminances=function(){return a.bytes},this.getMatrix=function(){return a.bytes},this.getWidth=function(){return a.width},this.getHeight=function(){return a.height},this.getLeft=function(){return a.left},this.getTop=function(){return a.top},this.getDataWidth=function(){return a.dataWidth},this.getDataHeight=function(){return a.dataHeight},this.isCropSupported=function(){return!0},this.crop=function(e,r,n,i){return new t(t,e,r,n,i)},this.invert=function(){for(var t=0,e=a.bytes.length;t<e;t++){var r=a.bytes[t];a.bytes[t]=255-r&255}return a}}return t}();var G=function(){function t(t,e){this.width=t,this.height=e}return t.prototype.getWidth=function(){return this.width},t.prototype.getHeight=function(){return this.height},t.prototype.isCropSupported=function(){return!1},t.prototype.crop=function(t,e,r,n){throw new Error("This luminance source does not support cropping.")},t.prototype.isRotateSupported=function(){return!1},t.prototype.rotateCounterClockwise=function(){throw new Error("This luminance source does not support rotation.")},t.prototype.rotateCounterClockwise45=function(){throw new Error("This luminance source does not support 45-degree rotation.")},t.prototype.toString=function(){var t=new Uint8Array(this.width);for(e=0;e<this.height;e++){var e,r=this.getRow(e,t);for(n=0;n<this.width;n++){var n,i=255&r[n],a=void 0;a=i<64?"#":i<128?"+":i<192?".":" "}t.push("\n")}return t.join("")},t}();var V,N=function(t){function e(e,r,n){var i,a,o=t.call(this,e.width,e.height)||this;o.delegate=e,o.dataWidth=r,o.dataHeight=n,o.left=0,o.top=0,o.luminances=new Uint8Array(r*n),o.luminances.fill(0);try{for(var s=__values(e.getMatrix().entries()),u=s.next();!u.done;u=s.next()){var l=__read(u.value,2),c=l[0],d=l[1];o.luminances[c]=d}}catch(h){i={error:h}}finally{try{u&&!u.done&&(a=s.return)}finally{if(i)throw i.error}}return o}return __extends(e,t),e.prototype.getRow=function(t,e){if(t<0||t>=this.getHeight())throw new Error("Requested row is outside the image: "+t);var r=this.getWidth();return null==e||e.length<r?e=new Uint8Array(r):B.fill(e,0),e.set(this.delegate.getRow(t+this.top,e).slice(this.left,this.left+r)),e},e.prototype.getMatrix=function(){return this.luminances.slice()},e.prototype.isCropSupported=function(){return!0},e.prototype.crop=function(t,r,n,i){return this.delegate.crop(this.left+t,this.top+r,n,i)},e.prototype.isRotateSupported=function(){return this.delegate.isRotateSupported()},e.prototype.rotateCounterClockwise=function(){return this.delegate.rotateCounterClockwise()},e.prototype.rotateCounterClockwise45=function(){return this.delegate.rotateCounterClockwise45()},e}(G),W=function(t){function e(e,r,n){var i=this;if(r<=0||n<=0)throw new Error("Buffer width and height must be greater than zero");return(i=t.call(this,r,n)||this).luminances=e,i.dataWidth=r,i.dataHeight=n,i.left=0,i.top=0,i}return __extends(e,t),e.prototype.getRow=function(t,e){if(t<0||t>=this.getHeight())throw new Error("Requested row is outside the image: "+t);for(var r=this.getWidth(),n=this.top*this.dataWidth+this.left,i=0;i<r;i++)e[i]=255&this.luminances[n+t*this.dataWidth+i];return e},e.prototype.getMatrix=function(){for(var t=this.getWidth(),e=this.getHeight(),r=new Uint8Array(t*e),n=this.top*this.dataWidth+this.left,i=0;i<e;i++){var a=i*t,o=n+i*this.dataWidth;r.set(this.luminances.slice(o,o+t),a)}return r},e.prototype.isCropSupported=function(){return!0},e.prototype.crop=function(t,r,n,i){var a=new e(this.luminances,this.dataWidth,this.dataHeight);return a.left=this.left+t,a.top=this.top+r,a.width=n,a.height=i,a},e.prototype.isRotateSupported=function(){return!0},e.prototype.invert=function(){return new z(this.width,this.height,this.getMatrix().slice())},e.prototype.rotateCounterClockwise=function(){for(var t=this.getWidth(),r=this.getHeight(),n=new Uint8Array(t*r),i=0;i<t;i++)for(var a=0;a<r;a++)n[i+(r-a-1)*t]=this.getMatrix()[i*r+a];return new e(n,r,t)},e}(G),X=function(t){function e(e,r,n,i,a,o,s,u){var l=t.call(this,i,a)||this;return l.image=e,l.width=r,l.height=n,l.dataWidth=i,l.dataHeight=a,l.left=o,l.top=s,l.reqWidth=u,l.luminances=new Uint8Array(r*n),l}return __extends(e,t),e.prototype.getRow=function(e,r){if(e<0||e>=this.getHeight())throw new Error("Requested row is outside the image: "+e);var n=this.getWidth();(null==r||r.length<n)&&(r=new Uint8Array(n));var i=(this.top+e)*this.dataWidth+this.left;if(1===this.image.length)return t.prototype.getRow.call(this,e,r);var a=new Uint8Array(4*this.width);a=this.image.slice(i,i+4*this.width);for(var o=0;o<this.width;o++)r[o]=(306*a[4*o]+601*a[4*o+1]+117*a[4*o+2]+512)>>10;return r},e.prototype.getMatrix=function(){var e=this.getWidth(),r=this.getHeight(),n=new Uint8Array(e*r);if(this.image)for(var i=0;i<r;i++){var a=this.getRow(i,null);for(j=0;j<e;j++)n[i*e+j]=a[j]}return t.prototype.getMatrix.call(this)},e.prototype.isCropSupported=function(){return!0},e.prototype.crop=function(t,r,n,i){return new e(this.image,this.dataWidth,this.dataHeight,n,i,this.left+t,this.top+r,this.reqWidth,this.reqHeight)},e}(W),j=function(){function t(t){this.source=t,this.buckets=new Int32Array(t.HISTOGRAM_BUCKETS),this.histogram=new Int32Array(t.HISTOGRAM_BUCKETS)}return t.prototype.getBlackMatrix=function(){var e,r=this.source,n=r.getWidth(),i=r.getHeight(),a=new O(n,i);this.initArrays(n);for(var o=1;o<5;o++){var s=Math.floor(i/8*o),u=this.estimateBlackPoint(this.getSlices(r,s,n),n);for(e=0;e<n;e++)a.set(e,s,r.getMatrix()[s*n+e]<u)}return this.thresholdBlock(r,0,0,n,i,a),a},t.prototype.thresholdBlock=function(e,r,n,i,a,o){for(var s=n;s<n+a;s++)for(var u=r;u<r+i;u++)o.set(u,s,e.getMatrix()[s*i+u]<this.getBlockBinarizer(e,u,s,i,a))},t.prototype.getBlockBinarizer=function(e,r,n,i,a){var o=n-t.SUB_SAMPLING_BLOCK_SIZE_Y,s=r-t.SUB_SAMPLING_BLOCK_SIZE_X,u=o+2*t.SUB_SAMPLING_BLOCK_SIZE_Y,l=s+2*t.SUB_SAMPLING_BLOCK_SIZE_X;return u>=a&&(u=a-1),l>=i&&(l=i-1),this.calculateBlockAverage(e,o,s,u,l)},t.prototype.calculateBlockAverage=function(t,e,r,n,i){return this.calculateSubBlockAverage(t,e,r,n,i)>>t.AVERAGING_STATE_SIZE},t.prototype.calculateSubBlockAverage=function(e,r,n,i,a){var o=0,s=0,u=0;for(y=r;y<i;y++)for(var l=e.getMatrix().slice(y*a,y*a+a),c=n;c<a;c++)o+=l[c],u++;var d=e.getMatrix();for(y=r;y<i;y++)for(var h=d.slice(y*a,y*a+a),f=n;f<a;f++)s+=h[f]*h[f];return Math.floor((o*o-s*u)/u)},t.prototype.getSlices=function(e,r,n){for(var i=e.getHeight(),a=e.getWidth(),o=new Int32Array(n*i),s=0;s<i;s++)o.set(e.getMatrix().slice(s*n,s*n+n),s*n);var u=Math.max(0,r-t.FRAME_HEIGHT),l=Math.min(i-1,r+t.FRAME_HEIGHT),c=2*t.FRAME_WIDTH+1,d=new Int32Array(c*n),h=0;for(s=u;s<=l;s++){var f=s-r;if(Math.abs(f)<=t.FRAME_HEIGHT){var p=Math.floor(Math.sqrt(t.FRAME_HEIGHT*t.FRAME_HEIGHT-f*f));for(x=Math.max(0,a/2-p);x<=Math.min(a-1,a/2+p);x++)d[h++]=o[s*a+x]}}return d},t.prototype.initArrays=function(t){this.buckets=new Int32Array(this.source.HISTOGRAM_BUCKETS),this.histogram=new Int32Array(this.source.HISTOGRAM_BUCKETS)},t.prototype.estimateBlackPoint=function(e,r){for(var n=e.length,i=0,a=0,o=Number.MAX_SAFE_INTEGER,s=0,u=0,l=0;l<n;l++){var c=e[l];if(a<c)a=c;if(o>c)o=c}for(var d=Math.floor((o+a)/2);u<3;u++){var h=0,f=0,p=0;for(l=0;l<n;l++){c=e[l];if(c>d)h++,p+=c;else f++,s+=c}var g,m,v;if(h>f?(g=h,m=f):(g=f,m=h),g<.1*n)return d;if(h>f)v=s;else v=p;var y=Math.floor(v/g);if(Math.abs(d-y)<=r)return d;d=y,u++}return d},t.SUB_SAMPLING_BLOCK_SIZE_X=2,t.SUB_SAMPLING_BLOCK_SIZE_Y=2,t.FRAME_WIDTH=15,t.FRAME_HEIGHT=15,t}(),Y=function(){function t(t){this.source=t,this.luminances=new Uint8Array(t.getWidth()),this.buckets=new Uint8Array(t.HISTOGRAM_BUCKETS)}return t.estimateBlackPoint=function(t){for(var e=t.length,r=0,n=0,i=0,a=0;a<e;a++){var o=255&t[a];r+=o,i<o&&(i=o),n>o&&(n=o)}if(i-n<=24)return i/2;var s=r/e,u=0;for(a=0;a<e;a++)o=255&t[a],u+=(o-s)*(o-s);var l=Math.sqrt(u/e),c=Math.max(n,s-2*l);return i-c<=24?Math.floor((i+c)/2):Math.floor(s/2+c/2)},t.prototype.getBlackRow=function(e,r){var n=this.source,i=n.getWidth();(null==r||r.getSize()<i)&&(r=new P(i));for(var a=n.getRow(e,this.luminances),o=this.buckets,s=0;s<i;s++)o[a[s]>>3]++;var u=t.estimateBlackPoint(o);if(i<3)for(s=0;s<i;s++)a[s]<u&&r.set(s);else{var l=255&a[0],c=255&a[1];for(s=1;s<i-1;s++){var d=255&a[s+1],h=(c+l+d)/3;h<u&&r.set(s),l=c,c=d}}return r},t.prototype.getBlackMatrix=function(){var t=this.source,e=t.getWidth(),r=t.getHeight(),n=new O(e,r);for(i=0;i<r;i++)n.setRow(i,this.getBlackRow(i,null));var i;return n},t}(),Z=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e.prototype.getBlackMatrix=function(){for(var t=this.source,e=t.getWidth(),r=t.getHeight(),n=new O(e,r),i=t.getMatrix(),a=0,o=0;a<r;a++,o+=e){var s=i.subarray(o,o+e),u=Y.estimateBlackPoint(s);for(p=0;p<e;p++)s[p]<u&&n.set(p,a)}return n},e}(j),q=function(t){function e(e){var r=t.call(this,e)||this;return r.matrix=null,r.width=0,r.height=0,r}return __extends(e,t),e.prototype.getBlackMatrix=function(){if(this.width===this.source.getWidth()&&this.height===this.source.getHeight())return this.matrix;this.width=this.source.getWidth(),this.height=this.source.getHeight();var t=this.width*this.height,e=this.source.getMatrix();this.matrix=new O(this.width,this.height);for(var r=0;r<t;r++){var n=e[r];(16711680&n)>>16;(65280&n)>>8;255&n;var i=(255&n)*this.RED_WEIGHT+(65280&n)>>8*this.GREEN_WEIGHT+(16711680&n)>>16*this.BLUE_WEIGHT>>this.LUMINANCE_SHIFT;this.luminances[r]=i,i<=this.LUMINANCE_CUTOFF&&this.matrix.set(r%this.width,Math.floor(r/this.width))}return this.matrix},e}(Y);var K=function(t){var e=this;this.image=t,this.width=t.width,this.height=t.height,this.getLuminances=function(){var t=e.width*e.height*4,r=new Uint8ClampedArray(t);return r.set(e.image.data),new Uint8ClampedArray(r)},this.getMatrix=function(){return e.getLuminances()},this.getWidth=function(){return e.width},this.getHeight=function(){return e.height},this.isCropSupported=function(){return!0},this.crop=function(t,r,n,i){return new K(w.from(e).getImageData(t,r,n,i))},this.invert=function(){for(var t=e.image.data,r=0,n=t.length;r<n;r+=4)t[r]=255-t[r],t[r+1]=255-t[r+1],t[r+2]=255-t[r+2];return new K(e.image)}};function J(t){return t.getLuminanceSource()}var Q=Object.freeze({getNotFoundInstance:function(){return new Error("No formula found")},getChecksumInstance:function(t){return new Error("Checksum error"+(t?": "+t:""))},getFormatInstance:function(t){return new Error("Format error"+(t?": "+t:""))},getIllegalStateInstance:function(t){return new Error("Illegal state"+(t?": "+t:""))},getUnsupportedOperationInstance:function(t){return new Error("Unsupported operation"+(t?": "+t:""))},getIllegalArgumentInstance:function(t){return new Error("Illegal argument"+(t?": "+t:""))}}),H=function(){function t(){}return t.prototype.decode=function(t,e){return this.decodeInternal(t,e)},t.prototype.decodeInternal=function(t,e){throw Q.getUnsupportedOperationInstance()},t.prototype.reset=function(){},t}();var $=function(){function t(t,e,r,n,i,a,o){this.a=t,this.b=e,this.c=r,this.d=n,this.e=i,this.f=a,this.g=o}return t.quadrilateralToQuadrilateral=function(e,r,n,i,a,o,s,u,l,c,d,h,f,p,g,m){var v=t.quadrilateralToSquare(e,r,n,i,a,o,s,u),y=t.squareToQuadrilateral(l,c,d,h,f,p,g,m);return y.times(v)},t.prototype.transformPoints=function(t){var e,r=t.length,n=this.a,i=this.d,a=this.g,o=this.b,s=this.e,u=this.h,l=this.c,c=this.f,d=this.i;for(e=0;e<r;e+=2){var h=t[e],f=t[e+1],p=l*h+c*f+a,g=t[e]=(n*h+o*f+l)/p,m=t[e+1]=(i*h+s*f+c)/p;g,m}},t.prototype.transformPointsWithValues=function(t,e){for(var r=this.a,n=this.b,i=this.c,a=this.d,o=this.e,s=this.f,u=this.g,l=this.h,c=this.i,d=t.length,h=0;h<d;h++){var f=t[h],p=e[h],g=i*f+s*p+c;t[h]=(r*f+n*p+u)/g,e[h]=(a*f+o*p+l)/g}},t.prototype.squareToQuadrilateral=function(e,r,n,i,a,o,s,u){var l=n-a,c=i-o,d=s-a,h=u-o,f=e-n+a-s,p=r-i+o-u;if(0===f&&0===p)return new t(n-e,s-n,e,i-r,u-i,r,0,0,1);var g=l*h-d*c,m=(f*h-d*p)/g,v=(l*p-f*c)/g;return new t(n-e+m*n,s-e+v*s,e,i-r+m*i,u-r+v*u,r,m,v,1)},t.prototype.quadrilateralToSquare=function(e,r,n,i,a,o,s,u){return t.squareToQuadrilateral(e,r,n,i,a,o,s,u).buildAdjoint()},t.prototype.buildAdjoint=function(){return new t(this.e*this.i-this.f*this.h,this.c*this.h-this.b*this.i,this.b*this.f-this.c*this.e,this.f*this.g-this.d*this.i,this.a*this.i-this.c*this.g,this.c*this.d-this.a*this.f,this.d*this.h-this.e*this.g,this.b*this.g-this.a*this.h,this.a*this.e-this.b*this.d)},t.prototype.times=function(e){return new t(this.a*e.a+this.d*e.b+this.g*e.c,this.a*e.d+this.d*e.e+this.g*e.f,this.a*e.g+this.d*e.h+this.g*e.i,this.b*e.a+this.e*e.b+this.h*e.c,this.b*e.d+this.e*e.e+this.h*e.f,this.b*e.g+this.e*e.h+this.h*e.i,this.c*e.a+this.f*e.b+this.i*e.c,this.c*e.d+this.f*e.e+this.i*e.f,this.c*e.g+this.f*e.h+this.i*e.i)},t}();var tt=function(){function t(){}return t.checkAndNudgePoints=function(t,e){for(var r=t.getWidth(),n=t.getHeight(),i=!0,a=0;a<e.length&&i;a+=2){var o=Math.floor(e[a]),s=Math.floor(e[a+1]);if(o<-1||o>r||s<-1||s>n)throw Q.getNotFoundInstance();i=!1,o===-1?(e[a]=0,i=!0):o===r&&(e[a]=r-1,i=!0),s===-1?(e[a+1]=0,i=!0):s===n&&(e[a+1]=n-1,i=!0)}i=!0;for(a=e.length-2;a>=0&&i;a-=2){o=Math.floor(e[a]),s=Math.floor(e[a+1]);if(o<-1||o>r||s<-1||s>n)throw Q.getNotFoundInstance();i=!1,o===-1?(e[a]=0,i=!0):o===r&&(e[a]=r-1,i=!0),s===-1?(e[a+1]=0,i=!0):s===n&&(e[a+1]=n-1,i=!0)}},t.distance=function(t,e,r,n){var i=t-r,a=e-n;return Math.sqrt(i*i+a*a)},t.round=function(t){return Math.floor(t+.5)},t}();var et=function(){function t(){}return t.getInstance=function(){return this.gridSampler},t.prototype.sampleGrid=function(t,e,r,n,i,a,o,s,u,l,c,d,h,f,p,g,m,v,y){throw new Error("not implemented")},t.prototype.sampleGridWithTransform=function(t,e,r,n){if(e<=0||r<=0)throw Q.getNotFoundInstance();var i=new O(e,r);if(null==n.transformPoints)throw new Error("transformPoints is null");var a=new Float32Array(2*e);for(y=0;y<r;y++){for(var o=a.length,s=y+.5,u=0;u<o;u+=2)a[u]=u/2+.5,a[u+1]=s;n.transformPoints(a);tt.checkAndNudgePoints(t,a);try{for(var l=0;l<o;l+=2)t.get(Math.floor(a[l]),Math.floor(a[l+1]))&&i.set(l/2,y)}catch(c){throw Q.getNotFoundInstance()}}return i},t.gridSampler=new t,t}(),rt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.sampleGrid=function(t,e,r,n,i,a,o,s,u,l,c,d,h,f,p,g,m,v,y){var b=$.quadrilateralToQuadrilateral(n,i,a,o,s,u,l,c,d,h,f,p,g,m,v,y);return this.sampleGridWithTransform(t,e,r,b)},e}(et),nt=function(){function t(t,e){this.x=t,this.y=e}return t.prototype.getX=function(){return this.x},t.prototype.getY=function(){return this.y},t.prototype.equals=function(e){if(e instanceof t){var r=e;return this.x===r.x&&this.y===r.y}return!1},t.prototype.hashCode=function(){return 31*this.x+this.y},t.prototype.toString=function(){return"("+this.x+", "+this.y+")"},t.orderBestPatterns=function(e){var r,n,i,a=o.distance,s=a(e[0],e[1]),u=a(e[1],e[2]),l=a(e[0],e[2]);u>=s&&u>=l?(n=e[0],r=e[1],i=e[2]):l>=u&&l>=s?(n=e[1],r=e[0],i=e[2]):(n=e[2],r=e[0],i=e[1]);var c=n.getX(),d=n.getY(),h=r.getX(),f=r.getY(),p=i.getX(),g=i.getY(),m=(p-h)*(d-f)-(c-h)*(g-f)<0?i:r,v=(p-h)*(d-f)-(c-h)*(g-f)<0?r:i;e[0]=m,e[1]=n,e[2]=v},t}();var it=function(t){function e(e,r,n,i,a,o,s){var u=t.call(this,e,r,n,i,a,o,s)||this;return u.value=0,u}return __extends(e,t),e}($),at=function(){function t(t,e){this.width=t,this.height=e}return t.prototype.setDimensions=function(t,e){this.width=t,this.height=e},t.prototype.getWidth=function(){return this.width},t.prototype.getHeight=function(){return this.height},t.prototype.detect=function(){throw new Error("Abstract method")},t}(),ot=function(t){function e(e,r,n){var i=t.call(this,e.getWidth(),e.getHeight())||this;return i.image=e,i.resultPointCallback=r,i.startI=n,i}return __extends(e,t),e.prototype.detect=function(){for(var t=this.image,e=this.getHeight(),r=this.getWidth(),n=new Array(5),i=this.startI,a=0,o=i;o<e;o++){n[0]=0,n[1]=0,n[2]=0,n[3]=0,n[4]=0;for(var s=0,u=0;u<r;u++){var l=t.get(u,o);if(l){if(1==(1&s))n[s]++;else if(4===s)if(this.foundPatternCross(n))if(!0===this.handlePossibleCenter(n,o,u))o=this.startI,n[0]=0,n[1]=0,n[2]=0,n[3]=0,n[4]=0,s=0,a=0;else{n[0]=n[2],n[1]=n[3],n[2]=n[4],n[3]=1,n[4]=0,s=3;continue}else n[0]=n[2],n[1]=n[3],n[2]=n[4],n[3]=1,n[4]=0,s=3;else n[++s]++;else 1===++s&&n[s]++}l||(1==(1&s)&&s++,n[s]++)}if(this.foundPatternCross(n))!0===this.handlePossibleCenter(n,o,r)&&(o=this.startI,a=0)}return[]},e.prototype.foundPatternCross=function(t){for(var e=0,r=0;r<5;r++){var n=t[r];if(0===n)return!1;e+=n}if(e<7)return!1;var i=e/7,a=i/2;return Math.abs(i-t[0])<a&&Math.abs(i-t[1])<a&&Math.abs(3*i-t[2])<3*a&&Math.abs(i-t[3])<a&&Math.abs(i-t[4])<a},e.prototype.handlePossibleCenter=function(t,e,r){return!1},e}(at),st=function(t){function e(e,r){var n=t.call(this,e,r,Math.floor(3*e.getHeight()/4))||this;return n.possibleCenters=new Array,n}return __extends(e,t),e.prototype.foundPatternCross=function(t){return p(t)},e.prototype.handlePossibleCenter=function(t,e,r){var n=this.crossCheckVertical(e,Math.floor(r),t[2],this.centerFromEnd(t,r));if(null!=n){for(var i=0,a=0;a<this.possibleCenters.length;a++){var s=this.possibleCenters[a];if(s.aboutEquals(n.getEstimatedModuleSize(),n.getY(),n.getX())){n=s.combineEstimate(n.getY(),n.getX(),n.getEstimatedModuleSize()),i=a;break}}i===this.possibleCenters.length&&this.possibleCenters.push(n)}return!1},e.prototype.crossCheckVertical=function(t,e,r,n){var i=this.image,a=i.getHeight(),o=this.getStateCountsWithinRange(t,e,r,n);if(null!=o){for(var s=0;null!=o[s];)s++;if(s>1)return new nt(o[1],o[0])}return null},e.prototype.getStateCountsWithinRange=function(t,e,r,n){return[t,e,r,n]},e.prototype.centerFromEnd=function(t,e){return e-t[4]-t[3]-t[2]/2},e}(ot),ut=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e.prototype.decode=function(){var t,e=this.image,r=new st(e,null),n=r.detect();if(Array.isArray(n)&&0===n.length)return null;var i=new Array;i.push(n[0]),i.push(n[1]),i.push(n[2]);var a,o,s;a=i[0],o=i[1],s=i[2];var u,l,c,d=a.getX(),h=a.getY(),f=o.getX(),p=o.getY(),g=s.getX(),m=s.getY();if((l=(g-f)*(h-p)-(d-f)*(m-p))<0)u=g,c=d,g=c,d=u,u=m,c=h,m=c,h=u;return new nt(d,h)},e}(H);var lt=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.decode=function(t,e){var r=t.getBlackMatrix(),n=new ut(r).decode();return null==n?null:new c("",null,0,[n],r_1.QR_CODE)},e.prototype.reset=function(){},e}(H);var ct=function(){function t(t,e){void 0===e&&(e=null);var r=t.getRawBytes();this.decoderResult=new gt(r,C.decode(r,E.UTF8),null,null),this.codewords=e,t.getRawBytes(),e}return Object.defineProperty(t.prototype,"getDecoderResult",{enumerable:!1,configurable:!0,get:function(){return this.decoderResult}}),Object.defineProperty(t.prototype,"getCodewords",{enumerable:!1,configurable:!0,get:function(){return this.codewords}}),t}();var dt=function(){function t(){}return t.prototype.decode=function(t,e){try{return this.doDecode(t,e)}catch(t){return null}},t}();var ht,ft;!function(t){t.OTHER=0,t.ERROR_CORRECTION_LEVEL=1,t.ISSUE_NUMBER=2,t.ORIENTATION=3,t.PDF417_EXTRA_METADATA=4,t.POSSIBLE_COUNTRY=5,t.STRUCTURED_APPEND_PARITY=6,t.STRUCTURED_APPEND_SEQUENCE=7,t.SUGGESTED_PRICE=8,t.UPC_EAN_EXTENSION=9,t.BYTE_SEGMENTS=10,t.SYMBOLOGY_IDENTIFIER=11}(ht||(ht={})),function(t){t.Cp437=0,t.ISO8859_1=1,t.ISO8859_2=2,t.ISO8859_3=3,t.ISO8859_4=4,t.ISO8859_5=5,t.ISO8859_6=6,t.ISO8859_7=7,t.ISO8859_8=8,t.ISO8859_9=9,t.ISO8859_10=10,t.ISO8859_11=11,t.ISO8859_13=12,t.ISO8859_14=13,t.ISO8859_15=14,t.ISO8859_16=15,t.SJIS=16,t.Cp1250=17,t.Cp1251=18,t.Cp1252=19,t.Cp1256=20,t.UnicodeBigUnmarked=21,t.UTF8=22,t.ASCII=23,t.GB18030=24,t.EUC_KR=25}(ft||(ft={}));var pt={};function gt(t,e,r,n,i,a){this.rawBytes=t,this.text=e,this.byteSegments=r,this.ecLevel=n,this.errorsCorrected=i,this.erasures=a}pt[ft.Cp437]=0,pt[ft.ISO8859_1]=1,pt[ft.ISO8859_2]=2,pt[ft.ISO8859_3]=3,pt[ft.ISO8859_4]=4,pt[ft.ISO8859_5]=5,pt[ft.ISO8859_6]=6,pt[ft.ISO8859_7]=7,pt[ft.ISO8859_8]=8,pt[ft.ISO8859_9]=9,pt[ft.ISO8859_10]=10,pt[ft.ISO8859_11]=11,pt[ft.ISO8859_13]=12,pt[ft.ISO8859_14]=13,pt[ft.ISO8859_15]=14,pt[ft.ISO8859_16]=15,pt[ft.SJIS]=20,pt[ft.Cp1250]=21,pt[ft.Cp1251]=22,pt[ft.Cp1252]=23,pt[ft.Cp1256]=24,pt[ft.UnicodeBigUnmarked]=25,pt[ft.UTF8]=26,pt[ft.ASCII]=27,pt[ft.GB18030]=28,pt[ft.EUC_KR]=30;var mt,vt;(mt=vt||(vt={}))[mt.Reader=0]="Reader",mt[mt.Scanner=1]="Scanner",mt[mt.Camera=2]="Camera";var yt,bt;!function(t){t[t.ERROR=0]="ERROR",t[t.INFO=1]="INFO",t.log=function(t,e,r){void 0===r&&(r=vt.Reader);var n=new Date,i=n.getHours().toString().padStart(2,"0")+":"+n.getMinutes().toString().padStart(2,"0")+":"+n.getSeconds().toString().padStart(2,"0")+"."+n.getMilliseconds().toString().padStart(3,"0");if(!1===this.options.debug)return;if(t===this.ERROR)return void console.error(i,vt[r]+":",e);t===this.INFO&&console.log(i,vt[r]+":",e)},t.setDebug=function(t){this.options.debug=t},t.options={debug:!1}}(yt||(yt={})),function(t){t[t.NONE=0]="NONE",t[t.AZTEC=1]="AZTEC",t[t.CODABAR=2]="CODABAR",t[t.CODE_39=3]="CODE_39",t[t.CODE_93=4]="CODE_93",t[t.CODE_128=5]="CODE_128",t[t.DATA_MATRIX=6]="DATA_MATRIX",t[t.EAN_8=7]="EAN_8",t[t.EAN_13=8]="EAN_13",t[t.ITF=9]="ITF",t[t.MAXICODE=10]="MAXICODE",t[t.PDF_417=11]="PDF_417",t[t.QR_CODE=12]="QR_CODE",t[t.RSS_14=13]="RSS_14",t[t.RSS_EXPANDED=14]="RSS_EXPANDED",t[t.UPC_A=15]="UPC_A",t[t.UPC_E=16]="UPC_E",t[t.UPC_EAN_EXTENSION=17]="UPC_EAN_EXTENSION",t[t.DECODED=18]="DECODED"}(bt||(bt={}));var Et,Ct,wt,St;!function(t){t[t.Start=0]="Start",t[t.Decode=1]="Decode",t[t.Stream=2]="Stream"}(Et||(Et={})),function(t){t[t.Video=0]="Video",t[t.Image=1]="Image",t.isValid=function(t){return"video"===t||"image"===t}}(Ct||(Ct={})),function(t){t.Assert=function(t,e){if(!t)throw new Error(e)}}(wt||(wt={})),function(t){t.isValid=function(t){return-1!==["video","audio","image"].indexOf(t)}}(St||(St={}));var _t=function(t){var e=this;this.tracks=t,this.stop=function(){e.tracks.forEach(function(t){return t.stop()})}};var At,It,Rt,Lt;(At=It||(It={}))[At.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",At[At.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE";var Mt=function(){function t(t,e){this.scanType=t,this.html5QrCode=e}return t.createFromScanType=function(e,r){return new t(e,r)},t.prototype.isScanFile=function(){return this.scanType===It.SCAN_TYPE_FILE},t}();(Rt=Lt||(Lt={}))[Rt.AZTEC=0]="AZTEC",Rt[Rt.CODABAR=1]="CODABAR",Rt[Rt.CODE_39=2]="CODE_39",Rt[Rt.CODE_93=3]="CODE_93",Rt[Rt.CODE_128=4]="CODE_128",Rt[Rt.DATA_MATRIX=5]="DATA_MATRIX",Rt[Rt.EAN_8=6]="EAN_8",Rt[Rt.EAN_13=7]="EAN_13",Rt[Rt.ITF=8]="ITF",Rt[Rt.MAXICODE=9]="MAXICODE",Rt[Rt.PDF_417=10]="PDF_417",Rt[Rt.QR_CODE=11]="QR_CODE",Rt[Rt.RSS_14=12]="RSS_14",Rt[Rt.RSS_EXPANDED=13]="RSS_EXPANDED",Rt[Rt.UPC_A=14]="UPC_A",Rt[Rt.UPC_E=15]="UPC_E",Rt[Rt.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION";var xt=function(){function t(){}return t.getCameras=function(e){return void 0===e&&(e=!1),new Promise(function(r,n){if(yt.setDebug(e),!navigator.mediaDevices)return n("Media Devices API not supported.");var i={facingMode:"environment"};navigator.mediaDevices.getUserMedia({audio:!1,video:i}).then(function(e){e.getVideoTracks().forEach(function(t){t.stop()}),t.enumerateDevices().then(function(t){for(var e=[],i=0;i<t.length;i++){var a=t[i];"videoinput"===a.kind&&(console.log(a),e.push({id:a.deviceId,label:a.label}))}r(e)}).catch(function(t){n("Failed to enumerate devices, error: "+t)})}).catch(function(t){n("Failed to get user media, error: "+t)})})},t.enumerateDevices=function(){return new Promise(function(t,e){navigator.mediaDevices.enumerateDevices().then(function(e){var r=[];e.forEach(function(t){"videoinput"==t.kind&&r.push({id:t.deviceId,label:t.label})}),t(r)}).catch(function(r){e("unable to enumerate devices: ("+r+")")})})},t}();var Tt=function(t){function e(e){return t.call(this,e,"Video stream has ended.")||this}return __extends(e,t),e}(Error);var Bt=function(){function t(t,e){void 0===e&&(e=!1),this.videoElement=t,this.verbose=e,this.stream=null,this.onCameraScanSuccessCallback=null,this.onCameraScanFailureCallback=null,this.onMediaStreamReceived=null}return t.prototype.start=function(t,e,r,n){var i=this;if(!r)throw"successCallback is required.";if(!n)throw"failureCallback is required.";this.onCameraScanSuccessCallback=r,this.onCameraScanFailureCallback=n;var a=null==t?{facingMode:"environment"}:"string"==typeof t?{deviceId:{exact:t}}:t;if(null==this.onMediaStreamReceived)this.onMediaStreamReceived=function(t){try{i.stream=t,i.videoElement.srcObject=t,i.videoElement.onloadedmetadata=function(e){i.videoElement.play(),i.startScanning(i.onCameraScanSuccessCallback,i.onCameraScanFailureCallback,e)}}catch(r){n("Failed to play video stream. "+r)}};navigator.mediaDevices.getUserMedia({audio:!1,video:a}).then(this.onMediaStreamReceived).catch(function(t){n("Error getting user media. "+t)})},t.prototype.stop=function(){this.localMediaStream.getVideoTracks().forEach(function(t){t.stop()})},t.prototype.startScanning=function(t,e,r){var n=this;if(this.localMediaStream=new _t(this.stream.getVideoTracks()),this.interval=setInterval(function(){n.scan(t,e)},500),!this.videoElement.videoWidth||!this.videoElement.videoHeight)throw"videoElement has no width or height."
},t.prototype.scan=function(t,e){if(this.videoElement.isPaused||this.videoElement.ended)return e("Video stream has ended.");try{var r,n=new w("camera-feed",this.videoElement.videoWidth,this.videoElement.videoHeight);n.drawImage(this.videoElement,0,0,this.videoElement.videoWidth,this.videoElement.videoHeight);var i=n.getCanvas();r=new lt;var a,o,s=i.getContext("2d");o=s.getImageData(0,0,i.width,i.height),a=new W(o.data,o.width,o.height,o.width,o.height,o.width,o.height,o.width);var u=new N(a,a.getWidth(),a.getHeight());t(r.decode(new a(u)).getText())}catch(l){e("Failed to scan. "+l)}},t}();var Ot=function(){function t(t,e){this.elementId=t,this.verbose=e}return t.prototype.start=function(t,e,r,n){var i=this;if(!r||!n)throw"successCallback and failureCallback both are required.";var a=this.createVideoElement(),o=this.createCanvasElement(a);document.getElementById(this.elementId).appendChild(o);var s=new Bt(a);return s.start(t,e,function(t){r(t)},function(e){var a=new Tt(e);n(a)}).then(function(t){return i.localScan=s,t}).catch(function(t){throw t})},t.prototype.stop=function(){return this.localScan.stop()},t.prototype.createVideoElement=function(t){void 0===t&&(t="qr-video");var e=document.createElement("video");return e.id=t,e.style.display="none",document.body.appendChild(e),e},t.prototype.createCanvasElement=function(t,e){void 0===e&&(e="qr-canvas");var r=document.createElement("canvas");return r.id=e,r.width=t.videoWidth,r.height=t.videoHeight,r},t}(),Pt=function(){function t(t,e,r,n){this.x=t,this.y=e,this.width=r,this.height=n}return t.create=function(e,r,n){return new t(e.x,e.y,r,n)},t.prototype.toHtml5Rect=function(){return{x:this.x,y:this.y,width:this.width,height:this.height}},t}();var Ut=function(){function t(t,e,r,n){this.isSuccess=t,this.decodedText=e,this.result=r,this.shouldStropStream=n}return t.createSuccess=function(e,r,n){return new t(!0,e,r,n)},t.createFailure=function(){return new t(!1,null,null,!1)},t}(),kt=function(){function t(){}return t.isValid=function(t){return!(!t||"string"!=typeof t||0===t.trim().length)},t.isUrl=function(e){var r=/^(http|https|ftp):\/\/[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,5}(:[0-9]{1,5})?(\/.*)?$/i;return!!t.isValid(e)&&r.test(e)},t}();var Dt,Ft=function(t){function e(e){var r=this;return(r=t.call(this)||this).verbose=e,r.options={useBarCodeDetectorIfSupported:!0,useInbuiltToolForFailure:!0},r}return __extends(e,t),e.prototype.decode=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return this.options.useBarCodeDetectorIfSupported&&this.isBarcodeDetectorSupported()?this.decodeWithBarcodeDetector(t):this.decodeWithZxing(t);case 1:return e.sent(),[2,Ut.createFailure()]}})})},e.prototype.isBarcodeDetectorSupported=function(){return"BarcodeDetector"in window},e.prototype.decodeWithBarcodeDetector=function(t){return __awaiter(this,void 0,void 0,function(){var e=this;return __generator(this,function(r){return[2,new Promise(function(r,n){var i=new window.BarcodeDetector;i.detect(t).then(function(n){if(0===n.length)return e.verbose&&console.log("No barcode detected by BarcodeDetector."),r(Ut.createFailure());var i=n[0];return e.verbose&&console.log(i.rawValue+" decoded by BarcodeDetector."),r(Ut.createSuccess(i.rawValue,null,!0))}).catch(function(t){return e.verbose&&console.error("'BarcodeDetector.detect()' failed. "+t),r(e.decodeWithZxing(t))})})]})},e.prototype.decodeWithZxing=function(t){var e,r,n,i,o=this,s=this.createCanvasElement(t.width,t.height),u=s.getContext("2d");u.drawImage(t,0,0);var l=u.getImageData(0,0,s.width,s.height);try{var c=new lt;n=new W(l.data,l.width,l.height,l.width,l.height,l.width,l.height,l.width),i=new N(n,n.getWidth(),n.getHeight()),e=new a(i);var d=c.decode(e);return o.verbose&&console.log(d.getText()+" decoded by zxing."),Ut.createSuccess(d.getText(),d,!0)}catch(h){return this.verbose&&console.log("decodeWithZxing() failed. "+h),o.options.useInbuiltToolForFailure?(r=this.decodeWithBuiltBinarizer(l),r):Ut.createFailure()}},e.prototype.decodeWithBuiltBinarizer=function(t){try{var e=new lt,r=new W(t.data,t.width,t.height,t.width,t.height,t.width,t.height,t.width),n=new N(r,r.getWidth(),r.getHeight()),i=new a(n,new Z(r)),o=e.decode(i);return this.verbose&&console.log(o.getText()+" decoded by zxing with built in binarizer."),Ut.createSuccess(o.getText(),o,!0)}catch(s){return this.verbose&&console.log("decodeWithBuiltBinarizer() failed to detect. "+s),Ut.createFailure()}},e.prototype.createCanvasElement=function(t,e){var r=document.createElement("canvas");return r.width=t,r.height=e,r},e}(dt),zt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._isScanning=!1,e.html5Qrcode=null,e}return __extends(e,t),e.prototype.scanFile=function(t,e){var r=this;if(!t||t.type.indexOf("image/")!==0)throw"Need an image file";var n=new FileReader;return n.onloadend=function(n){if(n.target.error)throw"Failed to read file. "+n.target.error;var i=new Image;i.onload=function(){var n=new Ft(r.verbose).decode(i);if(n.isSuccess)e(n.decodedText,n.result);else{var a=new Error("QR code parse error, error = QR code not found.");a.name=Dt,a.format=n.result,a.decodedText=n.decodedText,e(void 0,void 0,a)}},i.src=n.target.result},n.readAsDataURL(t)},e.prototype.scanFileV2=function(t,e){return __awaiter(this,void 0,void 0,function(){var r,n,i,a;return __generator(this,function(o){switch(o.label){case 0:if(!t||t.type.indexOf("image/")!==0)throw"Need an image file";return[4,this.imageToBitmap(t)];case 1:return r=o.sent(),[4,new Ft(this.verbose).decode(r)];case 2:if(!(n=o.sent()).isSuccess)throw(i=new Error("QR code parse error, error = QR code not found.")).name=Dt,i;return a={decodedText:n.decodedText,result:n.result},[2,a]}})})},e.prototype.start=function(t,e,r,n){var i=this;if(this._isScanning)throw"Scanning is already running, please call stop first.";var a=this.createVideoConstraints(t);return new Promise(function(t,o){i.reallyStart(a,e,r,n,t,o)})},e.prototype.reallyStart=function(t,e,r,n,i,a){var o=this;if(this.verbose)console.log("Constraints",t),console.log("config",e);var s=new Ot(this.element,this.verbose);return this.html5Qrcode=s,this.html5Qrcode.start(t,e,function(t,e){r(t,e)},function(t,e){n?n(t,e):o.verbose&&console.error(t,e)}).then(function(t){return o._isScanning=!0,i(t),t}).catch(function(t){return a(t),t})},e.prototype.stop=function(){var t=this;return this.html5Qrcode.stop().then(function(){return t._isScanning=!1,Promise.resolve()})},e.prototype.getRunningTrackCapabilities=function(){if(null==this.html5Qrcode)throw"Scanning is not running.";return this.html5Qrcode.getRunningTrackCapabilities()},e.prototype.applyVideoConstraints=function(t){if(null==this.html5Qrcode)throw"Scanning is not running.";return this.html5Qrcode.applyVideoConstraints(t)},e.prototype.createVideoConstraints=function(t){if("string"==typeof t)return{deviceId:{exact:t}};if(t&&t.deviceId&&t.facingMode)throw"You cannot include both deviceId and facingMode, use deviceId and remove facingMode.";if(t&&t.deviceId)return{deviceId:t.deviceId};if(t&&t.facingMode)return{facingMode:t.facingMode};if(t)return t;var e={};return e},e.prototype.imageToBitmap=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:if("createImageBitmap"in window)return[4,createImageBitmap(t)];case 1:return[2,e.sent()];case 2:return[2,this.imageToBitmapFallback(t)]}})})},e.prototype.imageToBitmapFallback=function(t){return __awaiter(this,void 0,void 0,function(){var e=this;return __generator(this,function(r){return[2,new Promise(function(r,n){var i=new FileReader;i.onloadend=function(n){var a=new Image;a.onload=function(){var n=e.createCanvasElement(a.width,a.height),i=n.getContext("2d");i.drawImage(a,0,0),r(i.getImageData(0,0,n.width,n.height))},a.src=n.target.result},i.readAsDataURL(t)})]})},e}(function(){function t(t,e){this.elementId=t,this.verbose=e,this.element=document.getElementById(t)}return t.prototype.createCanvasElement=function(t,e){var r=document.createElement("canvas");return r.width=t,r.height=e,r},t}()),Gt=function(t){var e,r=t.getContext("2d");if(null==r)throw"Canvas 2d context is not supported";return r.clearRect(0,0,t.width,t.height),r},Vt=function(){function t(t){this.decodedText=t}return t.prototype.getDecodedText=function(){return this.decodedText},t}();!function(t){t.getCameras=xt.getCameras}(Dt||(Dt={}));var Nt=function(){function t(t,e){void 0===e&&(e=!1),this.elementId=t,this.verbose=e,this._isScanning=!1,this.html5Qrcode=null,this.config=null,this.qrboxFunction=null,this.shouldScan=e,this.lastScan={time:Date.now(),decodedText:"##"},yt.setDebug(e)}return t.prototype.render=function(e,r){var n=this;this.qrCodeSuccessCallback=e,this.qrCodeErrorCallback=r;var i=this;document.getElementById(this.elementId).innerHTML="",this.shouldScan=!0;var a=this;this.containerElement=document.getElementById(this.elementId),this.containerElement.style.position="relative",this.createScanRegion(),this.html5Qrcode=new zt(this.elementId,this.verbose),this.startScanning(function(e,r){return n.onScanSuccess(e,r,a)},function(e,r){return n.onScanError(e,r,a)})},t.prototype.renderV2=function(t){var e=this;return this.config=t,this.qrCodeSuccessCallback=t.qrCodeSuccessCallback,this.qrCodeErrorCallback=t.qrCodeErrorCallback,new Promise(function(t,r){e.render(e.qrCodeSuccessCallback,e.qrCodeErrorCallback)})},t.prototype.start=function(t,e,r,n){var i=this;if(this._isScanning)throw new Error("Cannot start scanning, Already scanning");return new Promise(function(a,o){i.render(r,n),i.start(t,e,r,n).then(function(t){a(t)}).catch(function(t){o(t)})})},t.prototype.stop=function(){var t=this;return this.shouldScan=!1,this.html5Qrcode.stop().then(function(e){return Gt(t.canvasElement),Promise.resolve(e)})},t.prototype.scanFile=function(t,e){return this.html5Qrcode.scanFile(t,e)},t.prototype.scanFileV2=function(t,e){return this.html5Qrcode.scanFileV2(t,e)},t.prototype.clear=function(){Gt(this.canvasElement)},t.prototype.getRunningTrackCapabilities=function(){return this.html5Qrcode.getRunningTrackCapabilities()},t.prototype.applyVideoConstraints=function(t){return this.html5Qrcode.applyVideoConstraints(t)},t.prototype.onScanSuccess=function(t,e,r){var n=Date.now(),i=n-this.lastScan.time;if(this.shouldScan&&t!==this.lastScan.decodedText&&i>1e3)try{this.qrCodeSuccessCallback(t,new Mt(It.SCAN_TYPE_CAMERA,r)),this.lastScan.time=n,this.lastScan.decodedText=t}catch(a){console.error("qrCodeSuccessCallback failed",a)}},t.prototype.onScanError=function(t,e,r){this.qrCodeErrorCallback&&this.qrCodeErrorCallback(t,new Mt(It.SCAN_TYPE_CAMERA,r))},t.prototype.startScanning=function(e,r){var n=this;if(this.config)return this.html5Qrcode.start(this.config.videoConstraints,this.config,e,r);var i={aspectRatio:1,disableFlip:!1,qrbox:function(t,e){return n.qrboxFunction(t,e)},rememberLastUsedCamera:!0};this.html5Qrcode.start(void 0,i,e,r)},t.prototype.createScanRegion=function(){var t=this;this.scanRegionElement=document.createElement("div"),this.scanRegionElement.id=this.elementId+"__scan_region",this.scanRegionElement.style.position="absolute",this.scanRegionElement.style.top="0px",this.scanRegionElement.style.left="0px",this.scanRegionElement.style.width="100%",this.scanRegionElement.style.height="100%",this.scanRegionElement.style.minWidth="600px";var e=document.createElement("div");e.style.zIndex="10",e.style.width="100%",e.style.height="100%",e.style.border="60px solid rgba(0, 0, 0, 0.3)",e.style.borderRadius="30px",e.style.boxSizing="border-box",this.scanRegionElement.appendChild(e);var r=document.createElement("div");r.style.width="100%",r.style.height="100%",r.style.position="absolute",r.style.left="0px",r.style.top="0px",this.scanRegionElement.appendChild(r);var n=document.createElement("div");n.id=this.elementId+"__scan_line",n.style.position="absolute",n.style.height="10px",n.style.width="100%",n.style.background="red",n.style.top="0px",r.appendChild(n),this.containerElement.appendChild(this.scanRegionElement),this.qrboxFunction=function(e,r){var n=t.scanRegionElement,i={x:60,y:60};return{x:i.x,y:i.y,width:n.clientWidth-2*i.x,height:n.clientHeight-2*i.y}},this.canvasElement=this.html5Qrcode.createCanvasElement(),this.canvasElement.id=this.elementId+"__canvas",this.canvasElement.style.position="absolute",this.canvasElement.style.top="0px",this.canvasElement.style.left="0px",this.canvasElement.style.zIndex="1",this.containerElement.appendChild(this.canvasElement)},t.getCameras=xt.getCameras,t}(),Wt=function(){function t(t,e){this.verbose=e,this._isScanning=!1,yt.setDebug(e),this.elementId=t,this.element=document.getElementById(t),this.qrcode=null,this.canvasElement=null,this.videoElement=null,this._localMediaStream=null}return t.prototype.start=function(t,e,r,n){var i=this;if(this._isScanning)throw new Error("QR code scanning is already running. Stop it first on time.");var a=this.createVideoConstraints(t);return this.validateQrCodeCallback(r),new Promise(function(t,o){i.startInternal(a,e,r,n,t,o)})},t.prototype.stop=function(){var t=this;return new Promise(function(e,r){t.qrcode.stop(),t._localMediaStream.stop(),t._isScanning=!1,Gt(t.canvasElement),t.containerElement.removeChild(t.videoElement),t.containerElement.removeChild(t.canvasElement),e(!0)})},t.prototype.scanFile=function(t,e){var r=this;void 0===e&&(e=!0);if(!t||t.type.indexOf("image/")!==0)throw"Need an image file";return new Promise(function(n,i){r.scanFileV2(t,e).then(function(t){return n(t.decodedText)}).catch(i)})},t.prototype.scanFileV2=function(t,e){return __awaiter(this,void 0,void 0,function(){var r,n,i,a;return __generator(this,function(o){switch(o.label){case 0:return[4,this.createImageOrBitmap(t)];case 1:return r=o.sent(),[4,this.decode(r,e)];case 2:if(!(n=o.sent()).isSuccess)throw(i=new Error("QR code parse error, error = "+n.errorMessage)).name=Dt,i;return a={decodedText:n.decodedText,result:n.result},[2,a]}})})},t.prototype.clear=function(){Gt(this.canvasElement)},t.prototype.startInternal=function(t,e,r,n,i,a){var o=this,s=this;this._isScanning=!0,this._qrCodeSuccessCallback=r,this._qrCodeErrorCallback=n;var u=this.createVideoConstraints(t);this.containerElement=document.getElementById(this.elementId),this.containerElement.innerHTML="",this.videoElement=this.createVideoElement(this.videoElementId),this.containerElement.appendChild(this.videoElement);var l={aspectRatio:1,disableFlip:!1,qrbox:250,rememberLastUsedCamera:!0};if(e)l.aspectRatio=e.aspectRatio||l.aspectRatio,l.disableFlip=e.disableFlip||l.disableFlip,l.qrbox=e.qrbox||l.qrbox,l.rememberLastUsedCamera=void 0===e.rememberLastUsedCamera||e.rememberLastUsedCamera;this.qrcode=new Nt(this.videoElementId,l,this.verbose);var c=function(){o.qrcode.start(u,l,function(t){s._qrCodeSuccessCallback(t,new Vt(t))},function(t){o.qrCodeErrorCallback(t)})};c(),this.foreverScanRegion(),this.localScanTask=new Promise(function(t,e){i(!0)}).catch(a)},t.prototype.foreverScanRegion=function(){var t=this;this.foreverScanRegionInterval=setInterval(function(){if(t.videoElement){var e=t.videoElement.videoWidth/t.videoElement.clientWidth,r=t.videoElement.videoHeight/t.videoElement.clientHeight;t.canvasElement.width=t.videoElement.clientWidth,t.canvasElement.height=t.videoElement.clientHeight;var n=t.qrcode.getContext(),i=t.qrcode.getScanRegion();n.drawImage(t.videoElement,i.x*e,i.y*r,i.width*e,i.height*r,0,0,t.canvasElement.width,t.canvasElement.height)}},100)},t.prototype.createVideoElement=function(t){var e=document.createElement("video");return e.id=t,e.style.display="none",e},t.prototype.createCanvasElement=function(t,e){var r=document.createElement("canvas");return r.id=this.canvasElementId,r.width=t,r.height=e,r.style.display="inline-block",r},t.prototype.validateQrCodeCallback=function(t){if(!t)throw"qrCodeSuccessCallback is required callback."},t.prototype.createVideoConstraints=function(t){if(t){if(t.deviceId&&t.facingMode)throw'You can only specify one of the two, either "deviceId" or "facingMode".';return t.deviceId?"string"==typeof t.deviceId?{deviceId:{exact:t.deviceId}}:{deviceId:t.deviceId}:t.facingMode?{facingMode:t.facingMode}:t}return{}},t.prototype.decode=function(t,e){var r=this;return new Promise(function(n,i){var a=new Ft(r.verbose);a.decode(t,e).then(n).catch(i)})},t.prototype.createImageOrBitmap=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:if("createImageBitmap"in window)return[4,createImageBitmap(t)];case 1:return[2,e.sent()];case 2:return[2,this.createImageOrBitmapFallback(t)]}})})},t.prototype.createImageOrBitmapFallback=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,new Promise(function(e,r){var n=new FileReader;n.onloadend=function(r){var i=new Image;i.onload=function(){e(i)},i.src=r.target.result},n.readAsDataURL(t)})]})})},t.prototype.setupUi=function(t){var e,r=t.getBoundingClientRect();this.containerElement.style.position="relative",this.containerElement.style.height=r.height+"px",this.containerElement.style.width=r.width+"px",this.canvasElement=this.createCanvasElement(r.width,r.height),this.dummyCanvasElement=this.createCanvasElement(r.width,r.height),this.dummyCanvasElement.style.display="none",this.containerElement.appendChild(this.canvasElement),this.containerElement.appendChild(this.dummyCanvasElement),e=this.canvasElement.getContext("2d"),this.canvasContext=e},t.getCameras=xt.getCameras,t}();var Xt,jt;(Xt=jt||(jt={}))[Xt.CODABAR=0]="CODABAR",Xt[Xt.CODE_39=1]="CODE_39",Xt[Xt.CODE_93=2]="CODE_93",Xt[Xt.CODE_128=3]="CODE_128",Xt[Xt.EAN_8=4]="EAN_8",Xt[Xt.EAN_13=5]="EAN_13",Xt[Xt.ITF=6]="ITF",Xt[Xt.UPC_A=7]="UPC_A",Xt[Xt.UPC_E=8]="UPC_E";var Yt={};Yt[jt.CODABAR]=r.CODABAR,Yt[jt.CODE_39]=r.CODE_39,Yt[jt.CODE_93]=r.CODE_93,Yt[jt.CODE_128]=r.CODE_128,Yt[jt.EAN_8]=r.EAN_8,Yt[jt.EAN_13]=r.EAN_13,Yt[jt.ITF]=r.ITF,Yt[jt.UPC_A]=r.UPC_A,Yt[jt.UPC_E]=r.UPC_E;var Zt,qt;(Zt=qt||(qt={}))[Zt.AZTEC=0]="AZTEC",Zt[Zt.DATA_MATRIX=1]="DATA_MATRIX",Zt[Zt.MAXICODE=2]="MAXICODE",Zt[Zt.PDF_417=3]="PDF_417",Zt[Zt.QR_CODE=4]="QR_CODE",Zt[Zt.RSS_14=5]="RSS_14",Zt[Zt.RSS_EXPANDED=6]="RSS_EXPANDED",Zt[Zt.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION";var Kt={};Kt[qt.AZTEC]=r.AZTEC,Kt[qt.DATA_MATRIX]=r.DATA_MATRIX,Kt[qt.MAXICODE]=r.MAXICODE,Kt[qt.PDF_417]=r.PDF_417,Kt[qt.QR_CODE]=r.QR_CODE,Kt[qt.RSS_14]=r.RSS_14,Kt[qt.RSS_EXPANDED]=r.RSS_EXPANDED,Kt[qt.UPC_EAN_EXTENSION]=r.UPC_EAN_EXTENSION;var Jt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.decodeFromVideoDevice=function(t,e,r){var n,i=this;return this.reset(),this.startDecodeFromStream(this.constraintsForDevice(t),e,r).then(function(t){return n=t,i.addVideoSource(i.videoElement,i.videoElement.videoWidth,i.videoElement.videoHeight),i.decodeWithCallback(r),i}).catch(function(t){return i.reset(),Promise.reject(t)})},e.prototype.decodeFromConstraints=function(t,e,r){var n;return this.reset(),this.startDecodeFromStream(t,e,r).then(function(t){return n=t,this.addVideoSource(this.videoElement,this.videoElement.videoWidth,this.videoElement.videoHeight),this.decodeWithCallback(r),this}.bind(this)).catch(function(t){return this.reset(),Promise.reject(t)}.bind(this))},e.prototype.decodeFromStream=function(t,e,r){return this.reset(),this.startDecodeFromStream(this.constraintsForStream(t),e,r).then(function(){this.addVideoSource(this.videoElement,this.videoElement.videoWidth,this.videoElement.videoHeight),this.decodeWithCallback(r)}.bind(this)).catch(function(t){return this.reset(),Promise.reject(t)}.bind(this))},e.prototype.decodeOnceFromVideoDevice=function(t,e){return this.reset(),this.decodeFromVideoDevice(t,e,function(t,e){if(t)return t}).then(function(t){return this.stopStreams(),t}.bind(this))},e.prototype.decodeOnceFromConstraints=function(t,e){return this.reset(),this.decodeFromConstraints(t,e,function(t,e){if(t)return t}).then(function(t){return this.stopStreams(),t}.bind(this))},e.prototype.decodeOnceFromStream=function(t,e){return this.reset(),this.decodeFromStream(t,e,function(t,e){if(t)return t}).then(function(t){return this.stopStreams(),t}.bind(this))},e.prototype.decodeFromImage=function(t,e){return this.reset(),this.addImageSource(t,e),this.decodeWithCallback(function(t,e){if(t)return t})},e.prototype.decodeOnceFromImage=function(t,e){return this.decodeFromImage(t,e)},e.prototype.decodeFromVideoElement=function(t,e){return this.reset(),this.addVideoSource(t,t.videoWidth,t.videoHeight),this.decodeWithCallback(e)},e.prototype.decodeOnceFromVideoElement=function(t){return this.decodeFromVideoElement(t,function(t,e){if(t)return t}).then(function(t){return this.stopStreams(),t}.bind(this))},e.prototype.stopAsync=function(){this.stopStreams()},e}(function(){function t(t,e,r,n){this.reader=t,this.hints=e,this.timeBetweenScansMillis=r,this.videoElement=document.createElement("video"),this.imageElement=document.createElement("img"),this.canvasElement=document.createElement("canvas"),this.onresults=null,this.onerror=null,this.stream=null,this.videoPlaying=null,this.frame=null,this.oncanplay=this.onCanPlay.bind(this),this.ontrackended=this.onTrackEnded.bind(this)}return Object.defineProperty(t.prototype,"reader",{get:function(){return this._reader},set:function(t){this._reader=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hints",{get:function(){return this._hints},set:function(t){this._hints=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"timeBetweenScansMillis",{get:function(){return this._timeBetweenScansMillis},set:function(t){this._timeBetweenScansMillis=t},enumerable:!1,configurable:!0}),t.prototype.decodeWithCallback=function(t){return this.onresults=t,this.onerror=function(t){return yt.log(yt.ERROR,t,vt.Scanner)},this.decode()},t.prototype.decode=function(){var t=this;return this.frame=requestAnimationFrame(function(){return t.render()}),this},t.prototype.render=function(){var t=this;if(this.videoPlaying){this.canvasElement.width=this.videoElement.videoWidth,this.canvasElement.height=this.videoElement.videoHeight;var e=this.canvasElement.getContext("2d");e.drawImage(this.videoElement,0,0);var r=e.getImageData(0,0,this.canvasElement.width,this.canvasElement.height),n=new W(r.data,r.width,r.height);this.decodeSource(n)}setTimeout(function(){return t.frame=requestAnimationFrame(function(){return t.render()})},this.timeBetweenScansMillis)},t.prototype.onCanPlay=function(){this.videoPlaying=!0},t.prototype.onTrackEnded=function(){this.videoPlaying=!1,this.stop()},t.prototype.addVideoSource=function(t,e,r){this.videoElement=t,this.videoElement.width=e,this.videoElement.height=r,this.videoElement.addEventListener("canplay",this.oncanplay),this.videoElement.addEventListener("trackended",this.ontrackended)},t.prototype.addImageSource=function(t,e){var r;if(t instanceof HTMLImageElement)r=t.src;else{if(!(t instanceof HTMLVideoElement))throw new Error("Could not create image source from element "+t);r=t.poster}this.imageElement.src=r},t.prototype.decodeSource=function(t){try{var e=this.reader.decode(new a(t),this.hints);this.onresults&&this.onresults(e)}catch(t){t instanceof Q.getNotFoundInstance||(this.onerror&&this.onerror(t))}},t.prototype.stop=function(){this.frame&&cancelAnimationFrame(this.frame),this.stopStreams()},t.prototype.stopStreams=function(){this.stream&&(this.stream.getTracks().forEach(function(t){return t.stop()}),this.stream=null)},t.prototype.reset=function(){this.stop(),this.videoElement&&this.videoElement.removeEventListener("canplay",this.oncanplay),this.videoElement=null,this.onresults=null,this.onerror=null},t.prototype.startDecodeFromStream=function(t,e,r){var n=this;return this.reset(),navigator.mediaDevices.getUserMedia({video:t}).then(function(t){n.stream=t;var i=e instanceof HTMLVideoElement?e:document.getElementById(e);return i.srcObject=t,i.addEventListener("loadedmetadata",function(){i.play()}),n.videoElement=i,n.onresults=r,new Promise(function(t,e){i.addEventListener("canplay",function(){n.videoPlaying=!0,t()})})})},t.prototype.constraintsForDevice=function(t){return{deviceId:t}},t.prototype.constraintsForStream=function(t){var e=t.getVideoTracks();if(e.length>0){var r=e[0],n=r.getSettings(),i=r.getConstraints();return{deviceId:i.deviceId||n.deviceId,facingMode:i.facingMode||n.facingMode,groupId:i.groupId||n.groupId}}return{}},t.prototype.listVideoInputDevices=function(){return new Promise(function(t,e){xt.enumerateDevices().then(function(e){t(e)}).catch(function(t){e(t)})})}
}()),Qt=function(t){function e(e,r){void 0===r&&(r=null);var n=t.call(this,new lt,r)||this;return n.reader.possibleFormats=e,n}return __extends(e,t),e}(Jt),Ht=function(t){function e(e,r){var n,i=t.call(this,e,r);try{for(var a=__values(Object.keys(Yt)),o=a.next();!o.done;o=o.next()){var s=o.value;i[s]=Yt[s]}}catch(u){n={error:u}}finally{try{o&&!o.done&&(c=a.return)}finally{if(n)throw n.error}}var l,c;try{for(var d=__values(Object.keys(Kt)),h=d.next();!h.done;h=d.next()){var f=h.value;i[f]=Kt[f]}}catch(p){l={error:p}}finally{try{h&&!h.done&&(c=d.return)}finally{if(l)throw l.error}}return i}return __extends(e,t),e}(Qt);t.ArgumentException=Error,t.AztecCode=ct,t.BarcodeFormat=r,t.BinaryBitmap=a,t.Binarizer=function(){},t.BitArray=P,t.BitMatrix=O,t.BitSource=function(t){var e=this,r=0;this.getBitOffset=function(){return r},this.getByteOffset=function(){return Math.floor(r/8)},this.readBits=function(n){if(n<1||n>32||n>e.available())throw new Error("Can't read "+n.toString()+" bits");var i=0;if(r>0){var a=8-r,o=n<a?n:a,s=a-o,u=(255>>8-o<<s)&t[Math.floor(r/8)];i=u>>(s+=r%8)}if(n>o){var l=n-o;for(a=Math.floor(l/8),s=0;s<a;s++)i=i<<8|255&t[Math.floor(r/8)+s+1];r+=8*a;var c=l%8;c>0&&(s=(u=(255>>8-c<<8-c)&t[Math.floor(r/8)])>>8-c,i=i<<c|s,r+=c)}return i},this.available=function(){return 8*t.length-r}},t.BrowserAztecCodeReader=function(t){function e(){return t.call(this,new Array(r.AZTEC))||this}return __extends(e,t),e}(Ht),t.BrowserCodeReader=Jt,t.BrowserDatamatrixCodeReader=function(t){function e(){return t.call(this,new Array(r.DATA_MATRIX))||this}return __extends(e,t),e}(Ht),t.BrowserMultiFormatReader=Ht,t.BrowserPDF417Reader=function(t){function e(){return t.call(this,new Array(r.PDF_417))||this}return __extends(e,t),e}(Ht),t.BrowserQRCodeReader=Qt,t.ChecksumException=Q.getChecksumInstance(),t.CodabarReader=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(dt),t.Code128Reader=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(dt),t.Code39Reader=function(t){function e(e,r,n){t.call(this,e,r,n)}return __extends(e,t),e}(dt),t.Code93Reader=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(dt),t.DataMatrixReader=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(dt),t.DecodeHintType=i,t.Exception=Error,t.FormatException=Q.getFormatInstance(),t.HTMLCanvasElementLuminanceSource=K,t.HybridBinarizer=Z,t.ITFReader=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(dt),t.IllegalArgumentException=Q.getIllegalArgumentInstance(),t.IllegalStateException=Q.getIllegalStateInstance(),t.InvertedLuminanceSource=z,t.LuminanceSource=G,t.MathUtils=S,t.MultiFormatReader=function(t){function e(e){var r=t.call(this)||this;return r.hints=e,r.readers=new Array,r}return __extends(e,t),e.prototype.decode=function(t){this.setHints(this.hints);try{return this.decodeInternal(t)}catch(t){if(this.hints&&this.hints.get(i.TRY_HARDER)){var e=t.getBinarizer().getBlackMatrix(),r=new ut(e).decode();if(null!=r){var n=new Array;n.push(r);var a=new c("",null,0,n,r_1.QR_CODE);return a}return this.decodeInternal(t.invert())}throw new Q.getNotFoundInstance("No code found.")}},e.prototype.decodeWithState=function(t){this.readers||(this.readers=new Array);var e=this.decode(t);return e},e.prototype.setHints=function(t){var e,n,a=(this.hints=t)?this.hints.get(i.POSSIBLE_FORMATS):null,o=this.hints?void 0!==this.hints.get(i.ASSUME_GS1):!1;if(null!=a){var s=new Array;try{for(var u=__values(a),l=u.next();!l.done;l=u.next()){var c=l.value;s.push(this.createReaderByFormat(c))}}catch(d){e={error:d}}finally{try{l&&!l.done&&(n=u.return)}finally{if(e)throw e.error}}this.readers=s}else{this.readers=new Array;var h=new Array;h.push(r.EAN_13),h.push(r.UPC_A),h.push(r.EAN_8),h.push(r.UPC_E),this.readers.push(new Dt(t))}}}
,e.prototype.reset=function(){if(null!=this.readers){var t,e;try{for(var r=__values(this.readers),n=r.next();!n.done;n=r.next()){var i=n.value;i.reset()}}catch(a){t={error:a}}finally{try{n&&!n.done&&(e=r.return)}finally{if(t)throw t.error}}}},e.prototype.decodeInternal=function(t){var e,r;if(null==this.readers)throw new Q.getIllegalStateException("No readers where selected, nothing to decode.");try{for(var n=__values(this.readers),i=n.next();!i.done;i=n.next()){var a=i.value;try{var o=a.decode(t,this.hints);return o}catch(t){continue}}}catch(s){e={error:s}}finally{try{i&&!i.done&&(r=n.return)}finally{if(e)throw e.error}}throw new Q.getNotFoundInstance("No code found.")},e.prototype.createReaderByFormat=function(t){switch(t){case r.EAN_8:return new Ct;case r.EAN_13:return new Dt;case r.UPC_A:return new Ft;case r.QR_CODE:return new lt;case r.CODE_39:return new yt;case r.CODE_128:return new bt;case r.ITF:return new Et;case r.PDF_417:return new wt;case r.CODABAR:return new St;case r.DATA_MATRIX:return new _t;case r.AZTEC:return new At}return new Dt},e}(dt),t.MultiFormatUPCAReader=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e}(dt),t.NotFoundException=Q.getNotFoundInstance(),t.PDF417Reader=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(dt),t.PlanarYUVLuminanceSource=W,t.QRCodeReader=lt,t.RGBLuminanceSource=X,t.Reader=H,t.Result=s,t.ResultPoint=nt,t.StringUtils=A,t.UnsupportedOperationException=Q.getUnsupportedOperationInstance(),t.VideoInputDevice=function(t,e,r){this.deviceId=t,this.label=e,this.kind=r},t.Writer=function(){},t.WriterException=Error,t.ZXingHtml5QrcodeDecoder=Ft,t.ZXingHtml5QrcodeReader=function(t){function e(e){return t.call(this,"zxing-html5-qrcode-scanner",e)||this}return __extends(e,t),e}(Wt)});